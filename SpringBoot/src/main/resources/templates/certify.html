<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìê²©ì¦ í•©ê²© ì¸ì¦</title>

  <!-- CSRF Meta -->
  <meta name="_csrf" th:content="${_csrf.token}" />
  <meta name="_csrf_header" th:content="${_csrf.headerName}" />

  <!-- CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">

  <!-- JS -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
  <!-- ğŸ”· í—¤ë” -->
  <nav class="custom-header">
    <div class="container container-fluid d-flex justify-content-between align-items-center px-4">
      <div class="logo d-flex align-items-center gap-2">
        <a href="/">
          <img src="/images/ë¡œê³ .png" height="40" alt="ë¡œê³ ">
          <span class="logo-text"> </span>
        </a>
      </div>
      <div class="header-links d-flex gap-2">
        <th:block th:if="${session.info == null}">
          <a href="/login" class="btn btn-outline-primary">LOGIN</a>
          <a href="/join" class="btn btn-outline-secondary">JOIN</a>
        </th:block>
        <th:block th:unless="${session.info == null}">
          <a href="/mypage" class="btn btn-outline-secondary">MYPAGE</a>
          <a href="/logout" class="btn btn-outline-danger">LOGOUT</a>
        </th:block>
      </div>
    </div>
  </nav>

  <!-- ğŸ”³ ë©”ì¸ ì½˜í…ì¸  -->
  <div class="container py-5">
    <div class="row g-4 align-items-start">
      <!-- ğŸ“¸ ì˜ìƒ ì´¬ì˜ ì•ˆë‚´ ì´ë¯¸ì§€ -->
      <div class="col-md-8 d-flex flex-column">
        <h4 class="fw-bold mb-3"> </h4>
        <div class="flex-grow-1 d-flex">
          <img src="/images/certify_guide.png" alt="ì¸ì¦ ë°©ë²• ì•ˆë‚´" class="rounded border w-100 h-100 object-fit-contain">
        </div>
      </div>

      <!-- ğŸ“ ì¸ì¦ ì •ë³´ ì…ë ¥ -->
      <div class="col-md-4">
        <h4 class="fw-bold mb-3">ìê²©ì¦ í•©ê²© ì˜ìƒ ë° í™˜ë¶ˆ ì •ë³´ ì…ë ¥</h4>
        <form id="certifyForm" enctype="multipart/form-data">
          <div class="mb-3">
            <label for="licenseName" class="form-label">ìê²©ì¦ ì´ë¦„</label>
            <input type="text" class="form-control" id="licenseName" name="licenseName" required>
          </div>
          <div class="mb-3">
            <label for="file" class="form-label">í•©ê²© ì˜ìƒ</label>
            <input type="file" class="form-control" id="file" name="file" accept="video/*" required>
          </div>
          <div class="mb-3">
            <label for="bank" class="form-label">ì˜ˆê¸ˆì£¼</label>
            <input type="text" class="form-control" id="holder" name="holder" required>
          </div>
          <div class="mb-3">
            <label for="bank" class="form-label">ì€í–‰</label>
            <input type="text" class="form-control" id="bank" name="bank" required>
          </div>
          <div class="mb-3">
            <label for="account" class="form-label">ê³„ì¢Œë²ˆí˜¸</label>
            <input type="text" class="form-control" id="account" name="account" required>
          </div>
          <button type="submit" class="btn btn-primary w-100">í™˜ê¸‰ ì‹ ì²­</button>
        </form>
        <div id="resultMsg" class="mt-3"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer mt-5 py-4 border-top">
    <div class="container text-center">
      <nav class="nav justify-content-center mb-3">
        <a href="#" class="footer-link">Home</a>
        <a href="#" class="footer-link">About</a>
        <a href="#" class="footer-link">Contact</a>
      </nav>
      <p class="text-muted small mb-0">Â© 2025 ë¬¸ì œ Issue!</p>
    </div>
  </footer>

  <!-- JS: Ajax ì—…ë¡œë“œ -->
  <script>
    $(document).ready(function() {
      $('#certifyForm').on('submit', function(e) {
        e.preventDefault();

        const formData = new FormData(this);

        $.ajax({
          url: '/upload',
          type: 'POST',
          data: formData,
          processData: false,
          contentType: false,
          success: function(response) {
            if (response === 'success') {
              $('#resultMsg').html('<div class="alert alert-success">ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</div>');
            } else if (response === 'typeMismatch') {
              $('#resultMsg').html('<div class="alert alert-warning">ë™ì˜ìƒ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>');
            } else {
              $('#resultMsg').html('<div class="alert alert-danger">ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>');
            }
          },
          error: function() {
            $('#resultMsg').html('<div class="alert alert-danger">ì„œë²„ ì˜¤ë¥˜ë¡œ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>');
          }
        });
      });
    });
  </script>

</body>
</html>
